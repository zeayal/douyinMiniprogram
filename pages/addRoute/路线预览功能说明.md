# 路线预览功能说明

## 功能概述
为 `addRoute` 页面新增了路线预览功能，用户可以在保存路线之前预览途经点组成的 polyline 路线图。

## 新增功能

### 1. 预览按钮
- 在途经点管理区域底部添加了"预览路线"按钮
- 只有当存在途经点时才会显示
- 按钮采用渐变设计，视觉效果美观

### 2. 地图预览弹框
- 全屏弹框设计，提供沉浸式预览体验
- 弹框包含标题栏、地图区域和控制按钮栏

### 3. 地图功能
- **智能定位**：自动计算所有途经点的边界并居中显示，无需手动调整
- **自动缩放**：根据途经点分布自动计算最佳缩放级别，确保所有标记点都在视野内
- **标记点显示**：每个途经点显示为带编号的标记点
- **路线连线**：途经点之间用选定的颜色绘制连线，支持箭头指示
- **稳定显示**：地图位置完全固定，不会滑动，比例尺正常显示，用户可以专注查看路线布局
- **禁用交互**：禁用了地图的拖拽、缩放、旋转等交互功能，确保预览效果稳定

### 4. 地图控制
- **放大/缩小**：提供独立的缩放控制按钮，支持手动调整地图缩放级别
- **重置视图**：一键恢复到最佳显示状态，重新计算中心点和缩放级别
- **灵活操作**：支持手动缩放和自动适配，满足不同查看需求

## 技术实现

### 数据结构
```typescript
// 地图预览相关数据
showMapPreview: boolean,        // 是否显示地图预览弹框
mapScale: number,               // 地图缩放级别
mapCenter: {                    // 地图中心位置
  latitude: number,
  longitude: number
},
routeMarkers: any[],            // 路线标记点
routePolyline: any[]            // 路线连线
```

### 核心方法
- `showRoutePreview()`: 显示路线预览
- `generateRoutePreview()`: 生成预览数据
- `calculateOptimalMapView()`: 计算最优地图视图（中心点和缩放级别）
- `onMarkerTap()`: 处理标记点点击
- `zoomInMap()`: 放大地图
- `zoomOutMap()`: 缩小地图
- `resetMapView()`: 重置地图视图到最佳状态

### 样式特点
- 采用渐变色彩设计
- 响应式布局，适配不同屏幕尺寸
- 平滑的动画过渡效果
- 现代化的卡片式设计

## 使用流程

1. 用户添加途经点
2. 点击"预览路线"按钮
3. 弹框显示路线预览地图
4. 可以拖动、缩放地图查看详情
5. 点击关闭按钮或空白区域关闭预览

## 注意事项

- 需要确保途经点包含有效的经纬度坐标
- 地图组件需要微信小程序的地图权限
- 预览功能仅在存在途经点时可用
- 地图操作会实时更新状态，确保用户体验流畅
