# 颜色优化测试说明

## 优化目标

通过多重过滤和HSL色彩空间分析，确保选择的颜色：
1. 与需要避开的颜色有足够差异
2. 颜色之间也有足够的差异
3. 在地图上有良好的可读性

## 需要避开的颜色

- `#006400` - 深绿色（零星、一星、二星标记色）
- `#FF8C00` - 琥珀色（三星标记色）
- `#DC143C` - 深红色（四星标记色）
- `#9932CC` - 紫色（五星标记色）

## 优化后的颜色方案

### 第一层：蓝色系（与绿色、红色、紫色都有明显差异）
- `#1E90FF` - 道奇蓝（主色调）
- `#00BFFF` - 深天蓝
- `#87CEEB` - 天蓝色
- `#4682B4` - 钢蓝色

### 第二层：青色系
- `#20B2AA` - 浅海洋绿
- `#48D1CC` - 中绿松石
- `#7FFFD4` - 绿松石
- `#00CED1` - 暗绿松石

### 第三层：粉色系
- `#FF69B4` - 热粉红
- `#FFB6C1` - 浅粉红
- `#FFC0CB` - 粉红色
- `#FF1493` - 深粉红

### 第四层：橙色系
- `#FFA500` - 橙色
- `#FF7F50` - 珊瑚色
- `#FF6347` - 番茄色
- `#FF4500` - 橙红色

### 第五层：黄色系
- `#FFD700` - 金色
- `#FFFF00` - 黄色
- `#FFEFD5` - 桃色
- `#F0E68C` - 卡其色

### 第六层：紫色系（经过筛选，避开#9932CC）
- `#9370DB` - 中紫色
- `#8A2BE2` - 蓝紫色
- `#DA70D6` - 兰花紫
- `#DDA0DD` - 梅红色

## 技术实现

### 1. 颜色相似度检测
- 使用欧几里得距离算法计算RGB空间相似度
- 阈值设置为25%，比之前更严格
- 自动过滤掉与需要避开颜色相近的颜色

### 2. HSL色彩空间分析
- 色相差异：至少30度
- 饱和度差异：至少15%
- 亮度差异：至少20%
- 确保颜色在视觉上有足够差异

### 3. 多重过滤机制
- 第一层：基础安全颜色筛选
- 第二层：避开需要避开的颜色
- 第三层：HSL空间差异检测
- 第四层：备用颜色补充

## 测试方法

### 视觉测试
1. 在地图背景上测试每个颜色
2. 确保与地图标记色有足够对比
3. 验证颜色间的可区分性

### 技术测试
1. 使用`shouldAvoidColor()`函数测试
2. 使用`areColorsDistinctInHSL()`函数测试
3. 验证`getOptimizedSafeColors()`输出

### 对比测试
1. 与原始颜色方案对比
2. 与需要避开的颜色对比
3. 与地图标记色对比

## 预期效果

1. **更好的可读性**：颜色与地图标记色有足够差异
2. **更丰富的选择**：提供多种颜色选择，满足不同需求
3. **更智能的筛选**：自动避开相近颜色，减少用户困惑
4. **更专业的体验**：颜色搭配更协调，视觉效果更佳

## 使用建议

1. **主色调推荐**：使用`#1E90FF`（道奇蓝）作为默认颜色
2. **分类使用**：根据线路类型选择相应颜色分类
3. **自定义颜色**：使用颜色选择器时注意避开需要避开的颜色
4. **批量应用**：可以为不同类型的线路设置不同的颜色方案

## 更新记录

- 2024年：初始颜色方案
- 2024年：第一轮优化，避开特定颜色
- 2024年：第二轮优化，使用HSL空间分析
- 2024年：第三轮优化，多重过滤机制
